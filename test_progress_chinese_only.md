# 望遠鏡測試相關流程

## 指令手冊版本比較重點 (60 pages)
關於望遠鏡軟體的部份，我們跟 UNAM 討論過後，有提出新的要求以及關於使用手冊的內容需要釐清的部份。由於英文版手冊為 15年前 (2010) 的版本，日文手冊為去年 (2024) 的版本，內容我已經比對過。原本以為日文版應該是最完整的內容，但關於 Nasmyth 相關的指令以及狀態在日文版是缺失的，只在英文版中有提及。此外，指令、狀態、格式、數值範圍等在英文版與日文版有諸多衝突以及重複，我需要西村公司協助釐清。

由於文件是要給包括 UNAM 的人員使用，因此是英文版，如果需要翻譯成日文的話，請翻譯林先生協助處理，請西村公司確認正確性為何。

比較緊急或重要的要求是：
1. 望遠鏡伺服器的連線數，根據英文版，只允許四個連線，我們的控制軟體需要六個連線，希望能增加連線數到六。
2. 需要請西村公司提供能做 Pointing Model Map 的軟體，可以接受 Windows 軟體。
3. 雖然我們要跟 UNAM 共同開發控制軟體，仍希望能有一套 Windows 望遠鏡控制軟體做為可靠的備案（操作手冊上的 Master 軟體）。
4. 目前手冊內容沒有提及，但我們希望望遠鏡伺服器提供遠端 Power ON 的功能。
5. 目前手冊內容沒有提及，但我們希望望遠鏡伺服器提供溫度監測的資訊。

以上問題希望能在望遠鏡打包之前得到答覆，有的可能需要做功能上的更新。
接下來的問題只是需要釐清，因此可以晚點回覆。

完整內容請參考附件內容，一共有 60 頁，簡述如下。

第一部份 (p3-p5) 為整體問題，除了上述已經提到的比較緊急的 5 點以外，還有 20 點左右不緊急但是仍重要的問題，都在此一併提問。這些問題是發展自動化控制軟體很需要釐清的功能。

第二部份 (p6-p60) 為指令細節問題，頁數雖然很多但是要處理的問題並不困難。我逐項條列日文版以及英文版所有指令以及狀態碼，並在最後一個欄位 [Available] 設了 Check Box 要請西村公司一一勾選，確認哪個語言版本才是正確的，以及該指令或狀態碼是否依舊有效。
此外倒數第二個欄位為 [Note]，有一部分指令、狀態碼需要更精確的理解，因此要請西村公司幫忙釐清並回答。
這部份的問題同樣很重要，因為伺服器會將數個望遠鏡狀態以組合的形式呈現在一組 HEX 碼中，就算我們能正確解碼，如果我們無法識別狀態碼對應的望遠鏡狀態是哪一種，那我們等於無法與望遠鏡溝通。

由於時間緊急，因此先就以上的需求提出，UNAM 如果還有後續追加的問題，我會再更新文件內容。


## 現場測試
### 安裝 Python Package
檢查過後發現只需要安裝這個套件，因此就不再另外建立執行檔了。
```
$ pip install astropy
```
所有最新版的測試檔案會以 email 寄送，檔案請勿公開外流。

### 測試方法

每個測試檔案請執行至少五次，會自動紀錄結果到 log 檔案中。


#### 沒有望遠鏡伺服器的狀態下，模擬連線，需要在本機打開兩個終端機視窗
其中一個終端機視窗 (Terminal) 執行模擬伺服器程式：
```
$ python fake_server_advanced.py
```
另一個終端機視窗 (Terminal) 執行望遠鏡控制程式：

```
$ python test_commands_batch.py --batch test_commands.script

Select server to connect:
1. Fake server (127.0.0.1:8765)
2. Real server (192.168.11.111:8765)
3. Custom
Enter 1/2/3 (default 1): 
```
預設 1 會連線到本機端的模擬伺服器。

#### 有望遠鏡伺服器的狀態下，連線到望遠鏡伺服器，不需要執行 模擬伺服器程式

只要在本機打開一個終端機視窗 (Terminal) 執行望遠鏡控制程式：

```
$ python test_commands_batch.py --batch test_commands.script

Select server to connect:
1. Fake server (127.0.0.1:8765)
2. Real server (192.168.11.111:8765)
3. Custom
Enter 1/2/3 (default 1): 
```
望遠鏡伺服器的 IP 與 Port 預設為選項 2。如果望遠鏡伺服器的 IP 有變動，可以選擇 3 自訂 IP 與 Port。

